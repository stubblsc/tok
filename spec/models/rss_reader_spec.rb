require 'rails_helper'

RSpec.describe RssReader, type: :model do
  before :each do
    VCR.use_cassette("rss_feed") do
      @rss_reader = RssReader.new('http://rss.cnn.com/rss/cnn_topstories.rss')
    end
  end

  describe "#new" do
    it "takes a rss link as a parameter and returns an RssReader object" do
        expect(@rss_reader).to be_a RssReader
    end
  end

  describe "#channel_data" do
    it "returns the correct params and data for the channel" do
      channel_data = {
                       title: "CNN.com - RSS Channel - HP Hero",
                       description: "CNN.com delivers up-to-the-minute news and information on the latest top stories, weather, entertainment, politics and more.",
                       language: "en-US",
                       pub_date: Time.parse('2017-04-19 03:59:34 +0000'),
                       last_build_date: Time.parse('2017-04-19 04:01:16 +0000')
                     }

      expect(@rss_reader.channel_data).to eq channel_data
    end
  end

  describe "#article_data" do
    it "returns the correct params for the articles" do
      article_data = [{:title=>"Georgia Democrat could win House seat tonight -- and deal a blow to Trump", :description=>"The eyes of the political world are on Atlanta's northern suburbs Tuesday as voters go to the polls in a special election that's about much more than the House seat up for grabs.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/4Le1GDB9R1c/index.html"}, {:title=>"Trump releases robocall in Georgia special election ", :description=>"President Donald Trump releases a robocall in Georgia's 6th District special election.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/GMDU6a4dEZ0/trump-robocall-ossoff-nr-carroll.cnn"}, {:title=>"Georgia Dem hopeful dismisses questions about where he lives", :description=>"Democratic congressional candidate Jon Ossoff shrugged off questions Tuesday about his inability to vote for himself in a Georgia election, telling CNN's Alisyn Camerota his current living situation, outside the district, is temporary", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/ji1bXGSi19A/index.html"}, {:title=>"Killing of 3 white men is a hate crime, police say", :description=>"A man wanted in the slaying of a motel security guard fatally shot three men he apparently chose at random, Fresno, California, police said.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/A2UHwNJhEAE/index.html"}, {:title=>"Source: Fox News and Bill O'Reilly are talking exit", :description=>"Fox News will no longer even respond to questions about whether Bill O'Reilly will return to his show.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/LQ4yS6JE5DE/index.html"}, {:title=>"2 arrested at white nationalist's speech", :description=>"Auburn University is on edge about a possible speech Tuesday night by white nationalist Richard Spencer, whose inflammatory comments about race and religion have sparked protests at other schools where he has appeared.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/PR5ozS7wDRw/index.html"}, {:title=>"Trump's show of force was nowhere near N. Korea", :description=>"As the White House was talking about sending a naval \"armada\" to the Korean peninsula, the very ships in question were on their way to participate in military exercises in the Indian Ocean, some 3,500 miles in the opposite direction.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/PddAV9f_An0/index.html"}, {:title=>"1 killed in Blackhawk crash", :description=>"A UH-60 Blackhawk helicopter crashed on a golf course in Leonardtown, Maryland, during a routine training exercise Monday, killing one crew member and injuring two others, according to the US Army Military District of Washington.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/REXwQh11MBI/index.html"}, {:title=>"Russian bombers intercepted off Alaska", :description=>"Two Russian TU-95 Bear bombers were intercepted in international airspace off the coast of Alaska by two US F-22 Raptor fighter aircraft on Monday, the Pentagon confirmed to CNN.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/s0CGcyK1G6Y/index.html"}, {:title=>"Wounded vet carries woman to finish line", :description=>"", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/nXvEM0lmu6g/2704366-wounded-veterans-earl-granville-and-jose-sanchez-complete-boston-marathon"}, {:title=>"FBI used dossier allegations to bolster Trump-Russia investigation", :description=>"The FBI last year used a dossier of allegations of Russian ties to Donald Trump's campaign as part of the justification to win approval to secretly monitor a Trump associate, according to US officials briefed on the investigation.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/KPSA2gBafD0/index.html"}, {:title=>"George H.W. Bush hospitalized", :description=>"A spokesman for former President George H.W. Bush said the 92-year-old politician was re-admitted to a Houston hospital Friday over what turned out to be pneumonia.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/uZ8Hbmy2LdA/index.html"}, {:title=>"Trump shatters fundraising record", :description=>"Corporations and wealthy Americans poured nearly $107 million into the festivities surrounding Donald Trump's ascension to the presidency, doubling the previous inaugural fundraising record set eight years ago.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/Zlr9sjQ9aPk/index.html"}, {:title=>"Opinion: Will WH role pay dividends for Ivanka's business?", :description=>"As the President got ready to sell his latest executive order  to the American public, an overhaul of the H-1B skilled worker visa program, under his \"Buy American, Hire American\" slogan, Ivanka Trump appeared to be busy protecting the real emerald of the Trump family's vast business empire: China.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/L5HUxWNao-Y/index.html"}, {:title=>"Call to Erdogan reflects terrorism focus, White House says", :description=>"The Trump administration issued one mightily mixed message Monday.Â ", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/KFLHnS2gTx4/index.html"}, {:title=>"CNN Exclusive: Erdogan says new powers don't make him a dictator", :description=>"Turkish President Recep Tayyip Erdogan has insisted that his plans to assume sweeping new powers do not make him a dictator.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/9J9xfmakMms/index.html"}, {:title=>"Trump credibility takes new hit", :description=>"A new Gallup poll shows that only 45% of people surveyed trust President Trump to keep his promises, a 17% decrease from February.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/rx07C7UBNwE/trump-credibility-score-drop-gallup-poll-chalian-ath.cnn"}, {:title=>"President signs 'Buy American, Hire American' order", :description=>"President Donald Trump on Tuesday will sign an executive order directing federal agencies to implement the \"Buy American, Hire American\" rhetoric of his campaign.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/1HWgpdbGHjE/index.html"}, {:title=>"The typo that could be a symbol for Hillary Clinton's campaign", :description=>"rianna Keilar, Bianna Golodryga, and how a single letter proved symbolic of Hillary Clinton's ill-fated presidential campaign.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/51-ApFTZYfE/index.html"}, {:title=>"GOP sen. critiques Trump's trips ", :description=>"During a town hall meeting in Wall Lake, Iowa, Senator Joni Ernst was asked about the President's frequent travel to Florida. She said that she wishes that he would spend more time in Washington.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/I-7BdIjXRY8/joni-ernst-town-hall-trump-florida-sot-nr.cnn"}, {:title=>"UK election stunner: What just happened?", :description=>"British Prime Minister Theresa May has triggered the process for an early general election, sending shockwaves through the UK political world.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/7UZUgqq0uoc/index.html"}, {:title=>"Stephens kills himself after pursuit", :description=>"", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/L_bWvf_Eudg/index.html"}, {:title=>"McDonald's drive-thru pit stop leads to killer", :description=>"The order came through the McDonald's drive-thru window in Harborcreek Township, Pennsylvania, around 11 a.m. on Tuesday: Chicken McNuggets and a side of fries.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/GSTqhbDQAtA/index.html"}, {:title=>"Family comments on the cold-blooded killing", :description=>"A phone call. Then a scream on the other end.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/-eDuZ5wJ4iw/index.html"}, {:title=>"Son of victim: Dad was stripped of dignity", :description=>"In an exclusive interview with CNN's Don Lemon, the family of the man whose killing was posted to Facebook spoke about how their dad was stripped of his dignity.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/UyxO85r-piw/facebook-cleveland-homicide-victim-family-strip-of-dignity-sot-ctn.cnn"}, {:title=>"Victim's family: We forgive killer", :description=>"Their father's killing was coldly posted on Facebook and shared widely online, but Robert Godwin Sr.'s children say they forgive his killer.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/aKr-sRO6yfk/index.html"}, {:title=>"Facebook CEO mentions murder video at F8", :description=>"", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/MtrFAM61Jcc/index.html"}, {:title=>"Singer smokes weed with her adult kids", :description=>"Melissa Etheridge has gotten high with a little help from her family.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/F6hfik97GLU/index.html"}, {:title=>"India's most expensive film ever to cost ...", :description=>"With a budget of $155 million, India is set to make the longest poem ever written into its most expensive film ever.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/PW0AL-nDqF8/index.html"}, {:title=>"Egypt unearths 8 mummies in 3,500-year-old tombs", :description=>"Egyptian officials unearthed eight mummies, 10 colorful sarcophagi and numerous figurines in 3,500-year-old tombs, the Ministry of Antiquities announced Tuesday.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/dcxwnqFCfEE/index.html"}, {:title=>"Kushner is still selling off business assets", :description=>"", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/yYFrsU-XMSM/index.html"}, {:title=>"Extreme cyclist to bike 1,450km in 57 hours", :description=>"Sleep deprived, the mind begins to play tricks. Exhausted, the body begs for no more. But Jacob Zurl carries on. He must. Records can only be broken when the spirit refuses to bow.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/GKuxapn5Vf4/index.html"}, {:title=>"Jesuits and Georgetown repent for slave trading, 179 years later", :description=>"There is wide gulf, Frederick Douglass wrote in 1845, between Christianity proper and the \"slaveholding religion of this land.\" One is \"good, pure and holy,\" the other corrupt and wicked, the \"climax of all misnomers, the boldest of all frauds.\"", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/bizbkER7X5g/index.html"}, {:title=>"Baseball player hit by pitch four straight times", :description=>"", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/7-vMmUWPMyM/2704319-pirates-josh-harrison-gets-hits-by-pitch-in-4-consecutive-plate-appearances"}, {:title=>"Trump claims immunity in lawsuit", :description=>"President Donald Trump is claiming he cannot be sued now that he has won the White House -- a defense in a lawsuit that alleges Trump incited rally-goers to violence when they allegedly assaulted protesters during the 2016 campaign.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/Bjm0R71nMkk/index.html"}, {:title=>"Trump takes first step toward H-1B reform", :description=>"", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/-WDaoJkFSos/index.html"}, {:title=>"Obama snaps pic of Michelle on yacht ", :description=>"Former President Barack Obama snapped a photo of former first lady Michelle Obama as she posed on the top deck of a yacht where the couple and celebrity friends spent Friday morning off the island of Mo'orea, in the South Pacific.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/SJkRMKCF1qk/obama-snaps-photo-michelle-yacht-tsr.cnn"}, {:title=>"Lady Gaga, Prince William talk PTSD", :description=>"In a new FaceTime interview with Britain's Prince William for his Heads Together campaign, Lady Gaga discusses living with Post Traumatic Stress Disorder.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/YOyw-DxacKE/lady-gaga-prince-william-ptsd-interview.cnn"}, {:title=>"Facebook's struggle to remove violent videos", :description=>"Live streaming at the touch of a button: Brian Stelter explains why Facebook has been slow to respond to the recent string of violent videos depicting rape, murder, and torture on the social network.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/DPEasOaC1nY/facebook-violent-video-explainer.cnn"}, {:title=>"In Mauritius, an underwater waterfall ", :description=>"No one needs help finding a beautiful beach in Mauritius, but there's tons to explore away from the water as well.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/aTwspZZmggI/index.html"}, {:title=>"10 of the world's best fresh markets", :description=>"Green markets, farmers' markets, fresh markets, wet markets -- whatever you call them, these are the places that make Walmart, Tesco and other supermarket chains look like crimes against cuisine.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/1bSUMCha3No/index.html"}, {:title=>"Can apple vinegar help with weight loss?", :description=>"Apple cider vinegar is one of the most popular natural health products around, with claims for everything from sanitizing toothbrushes to whittling waistlines.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/i44oyUsKRiU/index.html"}, {:title=>"Anne Hathaway belts out badly translated songs ", :description=>"On \"The Tonight Show,\" actress Anne Hathaway and Jimmy Fallon sang popular song lyrics that had been translated to a foreign language and then back to English", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/fKtjjxEjhEA/anne-hathaway-jimmy-fallon-songs-jnd-orig-vstan.cnn"}, {:title=>"Facebook finally makes a virtual reality world", :description=>"Facebook just built a virtual reality version of ... Facebook.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/AYVW9DoiHfs/index.html"}, {:title=>"Breitbart and Trump relationship: it's complicated", :description=>"The latest source of angst for Breitbart came late last week, when Trump tapped former Republican Congressman Spencer Bachus to serve on the board of directors for the Export-Import Bank.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/_JI7VbgUdMk/index.html"}, {:title=>"5 last-minute tax tips you need to know now", :description=>"As you come down to the wire, make sure you follow these simple rules.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/fFhkWgcbO6s/index.html"}, {:title=>"This app will file your taxes for you", :description=>"With the 2017 tax filing deadline fast approaching, the Taxfyle app wants to simplify the process -- and take some of the stress away.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/tQ-jnPYOzzQ/index.html"}, {:title=>"Trump's congratulatory call to Erdogan is revealing", :description=>"", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/E_XiF2aLxAU/index.html"}, {:title=>"The other victim in Facebook killer's crime", :description=>"Just before Steve Stephens is seen shooting dead 74-year-old Robert Godwin, a grandfather whose family members describe him as \"one in a million,\" he forces the man to say a woman's name. Godwin, confused, complies. \"Yeah,\" Stephens responds. \"She's the reason why this is about to happen to you.\" Stephens pulls the trigger and later posts the video of the killing for a Facebook audience.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/1dhFB4LhObA/index.html"}, {:title=>"How many people have to die?", :description=>"Kim Fish, a patient care assistant and union member at Staten Island University Hospital, was on duty the night Superstorm Sandy hit New York four years ago. After evacuating their family to higher ground, her husband, Jon, returned home to watch over their property. As the storm intensified, Kim got a call from her sister-in-law with terrifying news. Jon was trapped in their living room by floodwaters up to his neck and didn't think he was going to survive.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/rUxt3QzTLXc/index.html"}, {:title=>"Biggest mistake to make in Georgia election ", :description=>"", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/Ap3YXn_Mw9Y/index.html"}, {:title=>"Could 'Fearless Girl' defeat 'Charging Bull'?", :description=>"Last week, Arthur Modica, the 76-year-old sculptor of Wall Street's ferocious \"Charging Bull,\" demanded the city of New York remove the \"Fearless Girl\" sculpture currently obstructing the flow of testosterone toward Wall Street. Modica's lawyer claims both his reputation and his work of art have been severely damaged by the city's decision to permit placement of the bronze little girl near the 18-foot-long bronze bull.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/Jn_fcUM_F0Q/index.html"}, {:title=>"Reverse mortgages: Too good to be true?", :description=>"", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/1VRge7lJjZY/"}, {:title=>"2 cards charging 0% interest until 2019", :description=>"", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/U6o4s-oDFvI/pay-0-interest-until-2019"}, {:title=>"10x interest savings accounts are terrifying banks", :description=>"", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/KO5aFFP0i_E/savings-accounts-mma-v3"}, {:title=>"Meet the conservative student activist who wants to 'make campus great again'", :description=>"It was standing room only as Lauren Cooley stepped in front of a classroom of college Republicans on a recent Saturday afternoon at the University of Central Florida's main campus.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/y59Syixv8kw/index.html"}, {:title=>"Barack Obama snaps photo of Michelle on yacht", :description=>"The Obamas are having the time of their post-White House lives.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/s_DZaG6LY5Q/index.html"}, {:title=>"Can this help us fight the flu?", :description=>"Finding ways to fight the flu just got a tad more ribbeting -- that is, if you ask some researchers who have turned their attention to frogs.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/7I04EKfqtHs/index.html"}, {:title=>"Should you take statins?", :description=>"When it comes to using statins to prevent a first heart attack or stroke, one leading US guideline recommends the drugs to 9 million more people than the other, according to a study published today in the Journal of the American Medical Association.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/5EkEhl3tZN0/index.html"}, {:title=>"Kevin Spacey to host Tony Awards", :description=>"Kevin Spacey is hosting the Tony Awards.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/nKbS5CH_4RQ/index.html"}, {:title=>"'Fargo' reloads, but FX show feels less special", :description=>"\"Fargo's\" \"Wow, they did it again\" second season has given way to a more mundane and familiar third installment -- pleasurable enough, but initially feeling more like a retread of what's come before than anything that builds on it.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/7DgdMm4QZyw/index.html"}, {:title=>"Mayte Garcia on the Prince you didn't know", :description=>"Many Prince fans are preparing for a day of mourning on the one-year anniversary of his death later this week.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/c4PKqe0OOE4/index.html"}, {:title=>"Lily Collins' pen pal? Michelle Obama", :description=>"And you thought you were having a good week.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/9zDhzkvuiJw/index.html"}, {:title=>"Kate Upton does her best Britney Spears", :description=>"Kate Upton debuted her Britney Spears impression on \"Lip Sync Battle\" Monday night.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/nnmmhfYGBMU/index.html"}, {:title=>"25 of the world's best honeymoon hotels", :description=>"", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/a4VbVM2_pNU/index.html"}, {:title=>"National Park Week: 10 highest, hottest, deepest  ", :description=>"", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/0fnp40lbwP0/index.html"}, {:title=>"Italy's forbidden 'orgy island' ", :description=>"", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/YeOSpaIT_Xo/index.html"}, {:title=>"That song doesn't mean what you think ", :description=>"At this very moment, there's a couple out there realizing that \"their\" song, the 2005 hit ballad \"You're Beautiful,\" has nothing to do with a loving, body-positive relationship and everything to do with a stalker who's stoned out of his mind.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/kpQVCXycS6I/index.html"}, {:title=>"'Mississippi Goddam' artist finally gets her due", :description=>"I was surfing online when I stumbled upon a mural in Baltimore painted by artist Ernest Shaw. It's a three-headed portrait of civil rights icons: James Baldwin, Malcolm X and, of course, Nina Simone.", :link=>"http://rss.cnn.com/~r/rss/cnn_topstories/~3/LH_2gPNa0lY/index.html"}]

      expect(@rss_reader.article_data).to eq article_data
    end
  end
end
